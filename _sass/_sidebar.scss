// _sass/_sidebar.scss
// Sidebar navigation drawer
// Extracted from Lanyon theme and modernized for 2025

//
// The sidebar is the drawer, the item we are toggling with our handy hamburger
// button in the corner of the page.
//
// This particular sidebar implementation was inspired by Chris Coyier's
// "Offcanvas Menu with CSS Target" article, and the checkbox variation from the
// comments by a reader.
//

// Prevent scroll on narrow devices when sidebar is open
html,
body {
  overflow-x: hidden;
}

// Wrapper for positioning sidebar without interfering with page content
.wrap {
  position: relative;
  width: 100%;
}

// Style and "hide" the sidebar
.sidebar {
  position: fixed;
  top: 0;
  bottom: 0;
  left: -$sidebar-width;
  width: $sidebar-width;
  visibility: hidden;
  overflow-y: auto;
  font-family: $font-base;
  font-size: .875rem; // 14px
  color: $color-sidebar-muted;
  background-color: $color-sidebar-bg;
  transition: all $transition-base;
}

@media (min-width: $bp-small) {
  .sidebar {
    font-size: .875rem; // Keep consistent
  }
}

// Sidebar content
.sidebar a {
  font-weight: $font-weight-normal;
  color: $color-sidebar-text;
  transition: background-color $transition-base;
}

.sidebar-item {
  padding: $spacing-sm;

  p:last-child {
    margin-bottom: 0;
  }
}

// Sidebar nav
.sidebar-nav {
  border-bottom: 1px solid $color-sidebar-hover;
}

.sidebar-nav-item {
  display: block;
  padding: $spacing-sm $spacing-md;
  border-top: 1px solid $color-sidebar-hover;
  min-height: 44px; // Touch target minimum
  display: flex;
  align-items: center;

  &.active,
  &:hover,
  &:focus {
    text-decoration: none;
    background-color: $color-sidebar-hover;
    border-color: transparent;
  }

  &:focus-visible {
    outline: 2px solid $color-accent;
    outline-offset: -2px;
  }
}

@media (min-width: $bp-large) {
  .sidebar-item {
    padding: $spacing-md;
  }

  .sidebar-nav-item {
    padding-left: $spacing-md;
    padding-right: $spacing-md;
  }
}

// Hide the sidebar checkbox that we toggle with `.sidebar-toggle`
.sidebar-checkbox {
  position: absolute;
  opacity: 0;
  user-select: none;
}

// Style the `label` that we use to target the `.sidebar-checkbox`
.sidebar-toggle {
  position: absolute;
  top: .8rem;
  left: $spacing-sm;
  display: flex;
  align-items: center;
  padding: 0.75rem $spacing-sm;
  min-width: 44px;  // Touch target minimum
  min-height: 44px; // Touch target minimum
  color: $color-text-muted;
  background-color: $color-bg;
  border-radius: $border-radius-sm;
  cursor: pointer;
  transition: all $transition-base;

  &::before {
    display: inline-block;
    width: 24px;  // Larger icon
    height: 24px; // Larger icon
    content: "";
    background: url("data:image/svg+xml,%3Csvg viewBox='0 0 16 16' fill='%2364748b' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' d='M2.5 11.5A.5.5 0 013 11h10a.5.5 0 010 1H3a.5.5 0 01-.5-.5zm0-4A.5.5 0 013 7h10a.5.5 0 010 1H3a.5.5 0 01-.5-.5zm0-4A.5.5 0 013 3h10a.5.5 0 010 1H3a.5.5 0 01-.5-.5z' clip-rule='evenodd'/%3E%3C/svg%3E") no-repeat center;
  }

  &:hover {
    background-color: $color-surface;
  }

  &:focus-visible {
    outline: 2px solid $color-accent;
    outline-offset: 2px;
    box-shadow: 0 0 0 3px rgba(0, 102, 255, 0.1);
  }
}

.sidebar-toggle:active,
#sidebar-checkbox:focus ~ .sidebar-toggle,
#sidebar-checkbox:checked ~ .sidebar-toggle {
  color: $color-bg;
  background-color: $color-text-muted;
}

.sidebar-toggle:active::before,
#sidebar-checkbox:focus ~ .sidebar-toggle::before,
#sidebar-checkbox:checked ~ .sidebar-toggle::before {
  background: url("data:image/svg+xml,%3Csvg viewBox='0 0 16 16' fill='%23fff' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' d='M2.5 11.5A.5.5 0 013 11h10a.5.5 0 010 1H3a.5.5 0 01-.5-.5zm0-4A.5.5 0 013 7h10a.5.5 0 010 1H3a.5.5 0 01-.5-.5zm0-4A.5.5 0 013 3h10a.5.5 0 010 1H3a.5.5 0 01-.5-.5z' clip-rule='evenodd'/%3E%3C/svg%3E") no-repeat center;
}

@media (min-width: 30.1em) {
  .sidebar-toggle {
    position: fixed;
  }
}

@media print {
  .sidebar-toggle {
    display: none;
  }
}

//
// Slide effect
//
// Handle the sliding effects of the sidebar and content in one spot, separate
// from the default styles.
//

.wrap,
.sidebar,
.sidebar-toggle {
  backface-visibility: hidden;
}

.wrap,
.sidebar-toggle {
  transition: transform $transition-base;
}

#sidebar-checkbox:checked + .sidebar {
  z-index: 10;
  visibility: visible;
}

#sidebar-checkbox:checked ~ .sidebar,
#sidebar-checkbox:checked ~ .wrap,
#sidebar-checkbox:checked ~ .sidebar-toggle {
  transform: translateX($sidebar-width);
}

//
// Reverse layout
//
// Flip the orientation of the page by placing the `.sidebar` and sidebar toggle
// on the right side.
//

.layout-reverse .sidebar {
  left: auto;
  right: -$sidebar-width;
}

.layout-reverse .sidebar-toggle {
  left: auto;
  right: $spacing-sm;
}

.layout-reverse #sidebar-checkbox:checked ~ .sidebar,
.layout-reverse #sidebar-checkbox:checked ~ .wrap,
.layout-reverse #sidebar-checkbox:checked ~ .sidebar-toggle {
  transform: translateX(-$sidebar-width);
}

//
// Overlay sidebar
//
// Make the sidebar content overlay the viewport content instead of pushing it
// aside when toggled.
//

.sidebar-overlay #sidebar-checkbox:checked ~ .wrap {
  transform: translateX(0);
}

.sidebar-overlay #sidebar-checkbox:checked ~ .sidebar-toggle {
  box-shadow: 0 0 0 .25rem $color-bg;
}

.sidebar-overlay #sidebar-checkbox:checked ~ .sidebar {
  box-shadow: $shadow-lg;
}

// Only one tweak for a reverse layout
.layout-reverse.sidebar-overlay #sidebar-checkbox:checked ~ .sidebar {
  box-shadow: -.25rem 0 .5rem rgba(0, 0, 0, .1);
}
